import{r as t,B as i,h as o,H as s}from"./p-0daa6e6f.js";import{p as a}from"./p-93f23b55.js";import"./p-0c550731.js";import"./p-f2660943.js";import"./p-b1e0c380.js";const n=class{constructor(i){t(this,i),this.modeToggle=!1,this.displayMode="grid",this.disableSearch=!1,this.selectOptions={},this.currentFilters={}}onPaginationElChange(){this.paginationEl&&(this.displayMode=this.paginationEl.display?this.paginationEl.display:this.displayMode)}onSuccess(t){var i;"select"===(null===(i=null==t?void 0:t.detail)||void 0===i?void 0:i.name)&&(this.selectOptions[t.detail.target.name]=t.detail.data.results)}onReset(){this.filterPopoverEl&&this.filterPopoverEl.dismiss()}async onSubmit(t){var i,o,s,a;if(!this.filterPopoverEl||"filter"!==(null===(i=null==t?void 0:t.detail)||void 0===i?void 0:i.name))return;if((null===(o=t.detail)||void 0===o?void 0:o.data)&&Object.keys(t.detail.data).length)for(const[i,o]of this.filter.controls.entries()){if(!o.name||!(null===(s=t.detail)||void 0===s?void 0:s.data[o.name]))continue;const a=Object.assign(Object.assign({},o),{value:t.detail.data[o.name]});this.filter.controls[i]=a,this.currentFilters[o.name]=a,this.filter=Object.assign({},this.filter)}if(this.filterPopoverEl.dismiss(),!this.paginationEl)return;await this.paginationEl.clearResults();let n={paramData:(null===(a=null==t?void 0:t.detail)||void 0===a?void 0:a.data)?t.detail.data:{}};this.beforeGetResults&&"function"==typeof this.beforeGetResults&&(n=await this.beforeGetResults(n)),this.paginationEl.getResults(n)}async onChange(t){var i,o;"orderBy"===(null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.name)&&(this.paginationEl.orderBy=t.detail.value),"ION-SEARCHBAR"===(null===(o=null==t?void 0:t.target)||void 0===o?void 0:o.tagName)&&(await this.paginationEl.clearParamData("next"),await this.paginationEl.clearParamData("back"),await this.paginationEl.clearParamData("page"),this.paginationEl.query=t.detail.value?t.detail.value:"")}async createFilterPopover(t){return this.filterPopoverEl=await a.create({component:"popover-filter",componentProps:Object.assign(Object.assign({},this.filter),{sort:this.sort}),event:t||null,cssClass:"popover-filter-wrapper"})}async togglePaginationDisplay(){this.displayMode="grid"===this.displayMode?"list":"grid",this.paginationEl.display=this.displayMode}async openFilterPopover(t){await this.createFilterPopover(t),this.filterPopoverEl.present()}async clearFilter(t,i){t.preventDefault(),t.stopPropagation();for(const[t,o]of this.filter.controls.entries())o.name&&o.value&&o.name===i.name&&(this.filter.controls[t]=Object.assign(Object.assign({},o),{value:null}),delete this.currentFilters[i.name],this.filter=Object.assign({},this.filter),await this.paginationEl.clearParamData(o.name));await this.paginationEl.clearResults(),await this.paginationEl.getResults(await new Promise((async(t,i)=>{try{const i={};for(const t of Object.values(this.currentFilters))i[t.name]=t.value;let o={paramData:i};this.beforeGetResults&&"function"==typeof this.beforeGetResults&&(o=await this.beforeGetResults(o)),t(o)}catch(t){console.log(t),i({})}})))}async componentDidLoad(){this.filter&&i.isBrowser&&await this.createFilterPopover()}render(){var t,i,a;return o(s,null,!this.disableSearch&&o("ion-searchbar",{style:{"--background":"transparent","--box-shadow":"none","--color":"var(--ion-text-color)"}}),(null===(i=null===(t=this.filter)||void 0===t?void 0:t.controls)||void 0===i?void 0:i.length)&&o("ion-button",{class:"filter-button",shape:"round",fill:"outline",color:"medium",onClick:t=>this.openFilterPopover(t)},o("ion-icon",{slot:"start",name:"funnel"}),o("ion-label",null,"Filter Â "),o("ion-text",{color:"primary",slot:"end"},null===(a=Object.keys(this.currentFilters))||void 0===a?void 0:a.length)))}static get watchers(){return{paginationEl:["onPaginationElChange"]}}};n.style="search-bar{display:flex;flex-direction:row;justify-content:space-between}search-bar .filter-button{margin:auto 80px auto auto}search-bar ion-searchbar{padding-top:4px;padding-bottom:4px}@media only screen and (max-width: 500px){search-bar .filter-button ion-label{display:none}}";export{n as floodteam_search_bar}