import{r as t,c as i,h as o}from"./p-a7779090.js";import{D as s}from"./p-bd7cdf38.js";import{f as a}from"./p-99b9854b.js";import"./p-bd8b186e.js";import"./p-eb85c436.js";import"./p-f2660943.js";import"./p-159f073c.js";const n=class{constructor(o){t(this,o),this.ionInput=i(this,"ionInput",7),this.fireenjinFetch=i(this,"fireenjinFetch",7),this.type="text",this.searchParams={},this.disableSearch=!1,this.mode="popover",this.results=[]}async checkValidity(t){return(this.required||t&&t.setValidationClass)&&await this.setValidationClass(t&&t.validationClassOptions?t.validationClassOptions:null),!this.inputEl||await(await this.inputEl.getInputElement()).checkValidity()}async reportValidity(){const t=!this.inputEl||await(await this.inputEl.getInputElement()).reportValidity();return this.inputEl.classList[t?"remove":"add"]("invalid"),await this.setValidationClass(),t}async onBlur(){const t=await this.checkValidity();this.inputEl.classList[t?"remove":"add"]("invalid"),await this.setValidationClass()}async onSuccess(t){var i,o,s,n,e,r,l;(null===(i=null==t?void 0:t.detail)||void 0===i?void 0:i.endpoint)===this.endpoint&&(this.results=this.resultsKey&&(null===(o=t.detail)||void 0===o?void 0:o.data)&&(null===(n=null===(s=t.detail)||void 0===s?void 0:s.data[this.resultsKey])||void 0===n?void 0:n.results)?null===(e=t.detail)||void 0===e?void 0:e.data[this.resultsKey].results:(null===(l=null===(r=t.detail)||void 0===r?void 0:r.data)||void 0===l?void 0:l.results)?t.detail.data.results:[],"popover"===this.mode&&(this.resultsPopover=await a.create({translucent:!0,showBackdrop:!1,event:t.detail.event,component:"floodteam-input-search-popover",componentProps:{results:this.results,template:this.template}}),this.resultsPopover.present()))}onInput(t){var i,o;this.disableSearch||(null===(o=null===(i=null==t?void 0:t.target)||void 0===i?void 0:i.value)||void 0===o?void 0:o.length)<=1||this.fireenjinFetch.emit({event:t,endpoint:this.endpoint,params:{data:Object.assign({query:t.target.value},this.searchParams)},dataPropsMap:this.dataPropsMap})}async clearResults(){return this.results=[]}async closePopover(){return this.resultsPopover.dismiss()}async openPopover(){return this.resultsPopover.present()}async setValidationClass(t){const i=Object.values(this.itemEl.classList);i.indexOf("invalid")>=0&&this.itemEl.classList.remove("invalid"),i.indexOf("valid")>=0&&this.itemEl.classList.remove("valid");const o=await(await this.inputEl.getInputElement()).checkValidity();(!t||!t.ignoreInvalid||t&&t.ignoreInvalid&&o)&&this.itemEl.classList.add(o?"valid":"invalid")}render(){var t;return[o("ion-item",{class:"search-input",ref:t=>this.itemEl=t,onClick:t=>this.onInput(t)},o("slot",{name:"start"}),this.iconStart&&o("ion-icon",{name:this.iconStart,slot:"start"}),this.label&&o("ion-label",{position:"stacked"},this.label),o("ion-input",{onInput:t=>this.onInput(t),ref:t=>this.inputEl=t,disabled:this.disabled,type:this.type,name:this.name,placeholder:this.placeholder,required:this.required,autofocus:this.autofocus,value:this.value}),this.iconEnd&&o("ion-icon",{name:this.iconEnd,slot:"end"}),o("slot",{name:"end"})),"inline"===this.mode&&(null===(t=this.results)||void 0===t?void 0:t.length)?this.results.map((t=>this.template(t))):null]}};(function(t,i,o,s){var a,n=arguments.length,e=n<3?i:null===s?s=Object.getOwnPropertyDescriptor(i,o):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)e=Reflect.decorate(t,i,o,s);else for(var r=t.length-1;r>=0;r--)(a=t[r])&&(e=(n<3?a(e):n>3?a(i,o,e):a(i,o))||e);n>3&&e&&Object.defineProperty(i,o,e)})([s(1e3)],n.prototype,"onInput",null),n.style='floodteam-input-search .search-input ion-label{color:var(--theme-dark-grey) !important;font-size:12px;font-weight:bold;text-transform:uppercase;font-family:arial;display:block;background:transparent;text-align:left;padding:0 0 8px 0;font-family:var(--theme-font-primary)}floodteam-input-search ion-icon{color:var(--ion-text-color)}floodteam-input-search .search-input ion-icon[slot="start"]{margin-right:5px}floodteam-input-search .search-input [slot="end"]{margin-left:5px}floodteam-input-search .invalid{--border-color:var(--ion-color-danger) !important}floodteam-input-search .invalid ion-label{color:var(--ion-color-danger) !important}floodteam-input-search .valid{--border-color:var(--ion-color-success) !important}floodteam-input-search .valid ion-label{color:var(--ion-color-success) !important}';export{n as floodteam_input_search}